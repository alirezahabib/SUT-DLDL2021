\chapter{
ماشین لباسشویی
}
\section{
طراحی کلی
}
این مدار کنترل کننده یک مدار ترتیبی ساده است که در شکل زیر حالت‌های آن آمده است. 

\begin{figure}[h!]
    \centering
    \input{part1/diagram.tikz}
    \caption{
    حالات اصلی
    }
    \label{fig:diag2}
\end{figure}

از آنجایی که در برخی حالات باید بیش از یک کلاک حضور داشته باشیم یک راه نگه داشتن این حالات و افزودن یک شمارنده برای هر حالت است و راه ساده‌تر که ما اینجا از آن استفاده می‌کنیم زیاد کردن تعداد حالت‌های معادل برای هر حالت است. یعنی مثلا حالتی که قرار است دو کلاک حضور داشته باشد، دو حالت فرعی معادل دارد.
در انتها این حالات فرعی را با مداری به حالت اصلی معادلشان تبدیل می‌کنیم.

حالات فرعی نهایی با شماره‌شان در شمارنده در شکل 
\eqref{fig:diag2}
آمده است.

\begin{figure}[h!]
    \centering
    \input{part1/diagram2.tikz}
    \caption{
    حالات فرعی
    }
    \label{fig:diag2}
\end{figure}

\section{
پیاده‌سازی سرد و گرم
}
از آنجایی که تنها تخطی ما از شمارش متوالی در حالت شست‌وشوی سرد است از فلیپ‌فلاپ استفاده نکردیم و از یک شمارنده‌ی ساده استفاده کردیم.

برای پیاده‌سازی این تخطی از قابلیت بارگذاری موازی شمارنده استفاده می‌کنیم.
یعنی هنگامی که کارکرد ماشین لباسشویی روی حالت سرد تنظیم شده مدار وقتی به اولین حالت گرم کردن آب می‌رسد درجا به حالت اصلی بعدی می‌پرد (حالت بعدی بارگذاری موازی می‌شود)

از آنجایی که بارگذاری موازی در این شمارنده آنی است و نه با کلاک، باید اولین حالت گرم کردن را در نظر بگیریم نه آخرین حالت قبل از آن را که در شکل
\eqref{fig:load}
مدار آن آورده شده.
ورودی گیت
NAND
یکی حالت تنظیم شده و دیگری حالت دیکد شده‌ی گرم کردن است.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/2.png}
    \caption{
    بارگذاری موازی در شمارنده
    }
    \label{fig:load}
\end{figure}

\section{
پیدا کردن حالات اصلی
}

پس از این که حالات شمارنده را دیکد کردیم به سادگی با OR
کردن حالاتت متناظر با هر حالت اصلی می‌توان متغییر مربوط به آن حالت را یافت که در شکل
\eqref{fig:or}
نحوه‌ی این کار آمده است.
البته می‌توان دیکدر را حذف کرد و با تعدادی گیت اند و نات حالات را مستقیما پیدا کرد که این کار مدار را ساده‌تر می‌کند اما تغییر و خوانایی آن را به شدت می‌کاهد و هر گونه تغییر را در آینده دشوار می‌سازد که در اینجا از این کار پرهیز شده.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/3.png}
    \caption{
    پیدا کردن حالات اصلی از روی حالات دیکد شده‌ی شمارنده
    }
    \label{fig:or}
\end{figure}

\section{
 کلاک با قبلیت دیباگ
}
در شکل
\eqref{fig:clock}
مشاهده می‌کنید که کلاکی با قابلیت دستی (دیباگ) و اتوماتیک
ساخته شده است.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/4.png}
    \caption{
    ساخت کلاک با قابلیت دیباگ (سوییچ بین حالت دستی و اتوماتیک)
    }
    \label{fig:clock}
\end{figure}

\section{
دکمه‌ی استارت هوشمند
}
دکمه استارت نباید باعث شود ماشین لباسشویی پس از ریست شدن دوباره شروع به کار کند.
پس این کلید از نوع
latched
نیست و از نوع
momentary 
است.
اما از طرفی نمی‌توان از مصرف‌کننده خواست که دکمه را به مدت یک کلاک نگه دارد.
بنابراین باید از یک 
latch 
کنترل‌شده
استفاده کرد که وقتی کار به پایان می‌رسد ریست شود.
در شکل \eqref{fig:start}
نحوه‌ی پیاده‌سازی آن نشان داده شده.

در صورتی که مدار در حالت
READY
یا
FINISH
باشد با زدن دکمه‌ی استارت ماشین شروع به شستن می‌کند و با زدن ریست مدار در هر حالتی باشد به حالت
READY
بر می‌گردد که یوزرفرندلی‌ترین ترکیب ممکن برای این دو دکمه است.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/5.png}
    \caption{
    استارت هوشمند
    }
    \label{fig:start}
\end{figure}

\section{
بوق اتمام کار
}
وقتی کار ماشین‌لباسشویی به پایان رسید به مدت دو کلاک مدار بازر چشمک‌زن و چراغ پایان‌کار چشمک می‌زنند.
برای این بوق به کلاک سریع‌تری با مرتبه فرکانسی حدود ۱ هرتز نیاز داریم.

مدت زمان این هشدار دو کلاک در نظر گرفته شده چرا که از ۱۶ حالت شمارنده دو تا باقی‌مانده بود و یک حالت مفت خالی داشتیم.
(البته می‌توان به سادگی خروجی پایان کار و ریست
latch
را از یک حالت بالاتر گرفت و یک حالت شمارنده را هدر داد)
این حالت را می‌توان با تغییری جزئی بعدا برای کارهای جانبی دیگر استفاده کرد.
(مثلا یک حالت تعمیر یا چنین چیزی)

پس از پایان این حالات هشدار پایان کار بوق قطع شده ولی چراغ پایان کار ثابت می‌ماند.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/7.png}
    \caption{
    buzzer
    یا
    بوق پایان کار
    }
    \label{fig:buzzer}
\end{figure}

\section{
گرمکن
}
خروجی
$T_2$
را می‌توان به یک رله وصل کرد تا آن نیز یک گرمکن را به برق شهری وصل کند.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/6.png}
    \caption{
    heater یا گرمکن
    }
    \label{fig:heater}
\end{figure}


\section{
موتور دو سرعته
}

با توجه به شکل
\eqref{fig:motor}
یک موتور دارای دور تند و کند قرار داده شده که دور کند آن به خروجی شست‌و‌شو و دور تند آن به خروجی خشک‌کن وصل است.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.5\textwidth]{part1/8.png}
    \caption{
    موتور دور تند و کند
    }
    \label{fig:motor}
\end{figure}


\section{مدار نهایی}
\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{part1/1.png}
    \caption{
    شکل مدار
    }
    \label{fig:final}
\end{figure}